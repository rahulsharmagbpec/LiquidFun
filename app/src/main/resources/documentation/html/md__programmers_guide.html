<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>LiquidFun Paint: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">LiquidFun Paint
   </div>
   <div id="projectbrief">Create art that moves, shakes, and delights.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="#about">About</a><br/>
 <a href="#pre">Prerequisites</a><br/>
 <a href="#atm">About this manual</a><br/>
 <a href="#frb">Feedback and reporting bugs</a><br/>
 <a href="#cc">Core concepts</a><br/>
 <a href="#mo">Modules</a><br/>
</p>
<p><a class="anchor" id="About"></a><br/>
</p>
<h2>About</h2>
<p>LiquidFun Paint is a simple painting game that showcases the fluid simulation in <a href="http://google.github.io/liquidfun/">LiquidFun</a>, with a polished look. The primary interaction of the player with the game is through the touch screen and the accelerometer built into the Android device.</p>
<p>With the touch screen, the player can draw multiple types of fluid particles, erase drawn particles, and move the particles around.</p>
<p>With the accelerometer, the player can tilt the device and change the perceived gravity, which will then cause the fluids to react and move towards the gravity pull.</p>
<p>The game is written in Java, using the <a href="http://www.swig.org">SWIG</a> component of <a href="http://google.github.io/liquidfun/">LiquidFun</a>. The <a href="http://www.swig.org">SWIG</a> component will generate JNI (Java Native Interface) functions to facilitate communication between C++ and Java. LiquidFun Paint also utilizes Eclipse, and the <a href="http://developer.android.com/sdk/index.html">Android SDK</a> and <a href="http://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a>, for UX design and for building the various Java and C++ components.</p>
<p><a class="anchor" id="pre"></a><br/>
 </p>
<h2>Prerequisites</h2>
<p>LiquidFun Paint is based on <a href="http://google.github.io/liquidfun/">LiquidFun</a>, a 2D fluid simulation library. Please refer to the <a href="http://google.github.io/liquidfun/">LiquidFun</a> site for more information and a tutorial on the library.</p>
<p>LiquidFun Paint is written in Java, and we recommend a working knowledge of the language before attempting to use the source code. In addition, if you choose to delve more into <a href="http://google.github.io/liquidfun/">LiquidFun</a>, you will need to have additional knowledge in C++ and <a href="http://www.swig.org">SWIG</a>. LiquidFun Paint should not be your first Android programming project! You should be comfortable with compiling, linking, and debugging.</p>
<p><b>Caution</b></p>
<p>LiquidFun Paint should not be your first Android or Java project. Please learn Java programming, compiling, linking, and debugging, especially for Android, before working with LiquidFun Paint. There are many resources for this on the Internet.</p>
<p><a class="anchor" id="atm"></a><br/>
</p>
<h2>About this manual</h2>
<p>This manual covers the basics of the LiquidFun Paint's code components. For anything that this manual does not cover, please refer to the comments in the source code.</p>
<p>This manual is only updated with new releases. The version in source control may be out of date.</p>
<p><a class="anchor" id="frb"></a><br/>
 </p>
<h2>Feedback and Reporting Bugs</h2>
<p>If you have a question or feedback about LiquidFun Paint, please leave a comment in the <a href="http://group.google.com/group/liquidfunpaint">Google group</a>. This is also a great place for community discussion.</p>
<p>LiquidFun Paint issues are tracked using GitHub.</p>
<p>Please file bugs and feature requests here: <a href="https://github.com/google/liquidfunpaint/issues">https://github.com/google/liquidfunpaint/issues</a></p>
<p>Please provide as much detail as you can when posting.</p>
<p><a class="anchor" id="cc"></a><br/>
 </p>
<h2>Core Concepts</h2>
<p>LiquidFun Paint uses a model-view-controller model.</p>
<p>Both the model and the view components are owned by the <code>Renderer</code> class. We need to synchronize between the physics simulation and the rendering. In order to keep a simple structure, whenever <code>onDrawFrame()</code> is called from OpenGL, we run the update/render loop.</p>
<p>The controller component is split into two classes - <code>Controller</code> and <code>MainActivity</code>. <code>Controller</code> implements listeners that respond to touch and accelerometer events, and those will in turn be used to manipulate <a href="http://google.github.io/liquidfun/">LiquidFun</a>. <code>MainActivity</code> is an Android activity which listens to Android UI components, and updates the <code>Controller</code> accordingly.</p>
<h3>Threading</h3>
<p>As <a href="http://google.github.io/liquidfun/">LiquidFun</a> is not reentrant, we need to ensure thread safety from the application itself. We initialize only one instance of <code>b2World</code> from <a href="http://google.github.io/liquidfun/">LiquidFun</a>, and within that, only one instance of <code>b2ParticleSystem</code>. We use ReentrantLocks to ensure safe access to both instances from other threads.</p>
<h3>Memory Management</h3>
<p>All <a href="http://google.github.io/liquidfun/">LiquidFun</a> objects are allocated through the C++ allocator. As a result, they should be properly cleaned up when they are not in use anymore. Please refer to the <a href="http://google.github.io/liquidfun/SWIG/html/index.html">LiquidFun SWIG documentation</a> for more details.</p>
<p><a class="anchor" id="mo"></a><br/>
 </p>
<h2>Modules</h2>
<h3>Renderer</h3>
<p>We have multiple renderers for different rendering purposes.</p>
<ul>
<li><p class="startli">Base Renderer</p>
<p class="startli">This implements <code>GLSurfaceView.Renderer</code>, the basic OpenGL ES renderer in the Android SDK.</p>
<ul>
<li><code>onSurfaceCreated</code></li>
</ul>
<p class="startli">This is called when the OpenGL surface is created or recreated after the context is lost. We will recreate all OpenGL objects as well as pass down the call to other renderers.</p>
<p class="startli">We also read JSON files here. The data from the JSON files are needed to initialize OpenGL objects.</p>
<p class="startli">For further information on GLSurfaceView.Renderer, please visit <a href="http://developer.android.com/reference/android/opengl/GLSurfaceView.Renderer.html">http://developer.android.com/reference/android/opengl/GLSurfaceView.Renderer.html</a>.</p>
</li>
<li><p class="startli">Debug Renderer</p>
<p class="startli">This extends the <code>b2Draw</code> class from <a href="http://google.github.io/liquidfun/">LiquidFun</a>, and allows for efficient debug rendering when prototyping. It is controllable via a static boolean constant.</p>
</li>
<li><p class="startli">Particle Renderer</p>
<p class="startli">This renders the fluid particle state from <a href="http://google.github.io/liquidfun/">LiquidFun</a>. It goes through <code>ParticleGroups</code> in succession, and determines which specific particle renderer to use. We have two renderers, one for loose water-like particles, the other for rigid body or wall particles.</p>
<p class="startli">The general flow for either type of particles is:</p>
<ul>
<li>Render particles as point sprites</li>
<li>Horizontal and vertical blur pass (<code>BlurRenderer</code>)</li>
<li>Copy water-like particles to screen with alpha thresholding (<code>ScreenRenderer</code>)</li>
<li>Copy other particles to screen alpha thresholding (<code>ScreenRenderer</code>)</li>
</ul>
</li>
<li><p class="startli">TextureRenderer</p>
<p class="startli">This is a basic texture renderer for ease of initializing and rendering any textures to the OpenGL context.</p>
</li>
</ul>
<h3>Controller</h3>
<p>The controller component is split into two classes.</p>
<ul>
<li><p class="startli">MainActivity</p>
<p class="startli">This controls all the visible UI, include the buttons for players to change drawing mode (tools) and colors, as well as the reset button to reset the whole canvas.</p>
</li>
<li><p class="startli">Controller</p>
<p class="startli">This intercepts touch events from the canvas, as well as accelerometer inputs, and passes the information onto the <a href="http://google.github.io/liquidfun/">LiquidFun</a> component. We have the following tools:</p>
<ul>
<li><code>PencilTool</code>: Draw particles that will not move or be affected by fluids.</li>
<li><code>RigidTool</code>: Draw particles that will float, bob and move with the fluid.</li>
<li><code>WaterTool</code>: Draw particles that flow, drip and slosh realistically.</li>
<li><code>EraserTool</code>: Erases particles.</li>
<li><code>MoveTool</code>: Move particles. </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-49880327-7', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
